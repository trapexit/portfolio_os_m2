;******************************************************************************;*;*  Copyright (c) 1993-1996, an unpublished work by The 3DO Company.;*  All rights reserved. This material contains confidential;*  information that is the property of The 3DO Company. Any;*  unauthorized duplication, disclosure or use is prohibited.;*  ;*  @(#) allpass_filter.mp 95/12/15 1.2;*  Distributed with Portfolio V33.9;*  ;*  Allpass filter.;*;*  Unlike the comb and lpcomb filter examples, the allpass filter has a;*  flat frequency response.  It does, however, have a frequency-dependent;*  phase response, so an input signal gets smeared in time.  This;*  functions nicely as the final stage of a complex reverb to smooth;*  over artifacts.  In addition, by using one allpass filter on each;*  output channel with slightly different settings, the outputs for each;*  channel are smeared differently.;;                       -g;                      +---+          dry signal;  -+----------------->| * |-------------------------------+;   |                  +---+                               |;   |                                                      v ;   |  +---+        +---------+             +---+        +---+;   +->| + |------->|  delay  |-----+------>| * |------->| + |----->;      +---+        +---------+     |       +---+        +---+ ;        ^                          |       1-g**2;        |             +---+        |;        +-------------| * |<-------+;                      +---+;                        g;;*  As you can see, the gains are all correlated.  This patch includes a;*  control path subpatch that, given the value "g" outputs "g", "-g" and;*  "1-g**2" into the appropriate mixer channels.;;                 -1 >---+ ;                      +-+-+          ;   +----------------->| * |------------------+--------------------> -g;   |                  +---+                  |;   |                                         v             ;   |                                       +---+;   |                                       | A | *+.dsp;   |                                       +---+        ;  -+-------------------------------------->| B |------------------> 1-g**2;  g|                                       +---+         ;   |                               1 >---->| C |;   |                                       +---+;   |;   +--------------------------------------------------------------> g;;******************************************************************************; Allpass reverb filter; Signal-path InstrumentsInput Input 1 SignedInstrument DelOut1 sampler_raw_f1.dspInstrument DelIn1 delay_f1.dspDelayline Delay1 630 1		; about 6msMixer InMix1 2 1Mixer OutMix1 2 1Output Output 1 Signed 1; Hook up the delay lines to the ins and outsExpose dOutFIFO1 DelOut1 InFIFOAttach Delay1 dOutFIFO1 -startat 50Expose dInFIFO1 DelIn1 OutFIFOAttach Delay1 dInFIFO1; Hook up the signal pathConnect	.	Input	0	InMix1	Input	0Connect	.	Input	0	OutMix1	Input	0Connect	InMix1	Output	0	DelIn1	Input	0Connect	DelOut1	Output	0	OutMix1	Input	1Connect	DelOut1	Output	0	InMix1	Input	1Connect	OutMix1	Output	0	.	Output	0; Knob to tweak the gainKnob allp_g 1 Signed 0.35	; scaled by 2 so we don't go over 1.0; Control-path InstrumentsInstrument -g multiply.dspInstrument 1-(g*g) timesplus.dsp; Connect the control pathConnect	.	allp_g	0	-g	InputA	0Constant			-g	InputB	0	-1.0Connect	-g	Output	0	OutMix1	Gain	0Connect	-g	Output	0	1-(g*g)	InputA	0Connect	.	allp_g	0	1-(g*g)	InputB	0Constant			1-(g*g) InputC	0	1.0Connect	1-(g*g)	Output	0	OutMix1	Gain	1Connect	.	allp_g	0	InMix1	Gain	1