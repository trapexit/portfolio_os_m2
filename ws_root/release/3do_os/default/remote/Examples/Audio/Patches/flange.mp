;******************************************************************************;*;*  Copyright (c) 1993-1996, an unpublished work by The 3DO Company.;*  All rights reserved. This material contains confidential;*  information that is the property of The 3DO Company. Any;*  unauthorized duplication, disclosure or use is prohibited.;*  ;*  @(#) flange.mp 96/03/01 1.3;*  Distributed with Portfolio V33.9;*  ;*  Tutorial 15: Triangle lfo modulating the tap on a delay line, using the;*  drift sampling instrument.;*;******************************************************************************; --------------------- sawtooth input - uncomment if desired; Instrument Source sawtooth.dsp; Connect Source Output 0 Mixer Input 0; Knob Frequency 1 OscFreq 440.0; Knob Amplitude 1 Signed 0.8; Connect . Frequency 0 Source Frequency 0; Connect . Amplitude 0 Source Amplitude 0; --------------------- line inputInput Input 1 SignedConnect . Input 0 Mixer Input 0; --------------------- drift sampler; This instrument has a port, "Drift", that's 0 when the sampler is ; marching through one sample at a time.  At other frequencies when the; sampler is interpolating, Drift ramps up or down, indicating how many; samples away from the "nominal" point we are.; By hooking the sampler to a delay, and modifying the sample rate, we; are effectively increasing or decreasing the tap reader-writer distance.; We use the Drift value to precisely control this change; we set an; "offset", which is the distance we want the tap to be set at, and then; vary the sample rate continuously until we're at that offset and the; Drift is 0.; By driving the offset with a continuously varying source (in this case,; a triangle LFO), we end up continuously modulating the tap distance, and; the result is some degree of pitch shifting up and down at the output of; the sampler.  In small degrees, when mixed with the original signal, the; result is the comb-filtered "flanging" effect we all know and love.  With; larger modulation amplitudes, we get serious pitch chorusing, and with; faster modulation frequencies we get something akin to FM-y delay.Instrument Tap sampler_drift_v1.dspInstrument *+ timesplus_noclip.dspInstrument - subtract.dspConstant *+ InputC 0 -1.0; By scaling the drift value, we can make the sample rate move faster or; slower toward the desired offset, effectively making the sampler "drift; back" faster or slower.Knob Driftback 1 Signed -0.18Connect Tap Drift 0 - InputA 0Connect - Output 0 *+ InputA 0Connect . Driftback 0 *+ InputB 0Connect *+ Output 0 Tap SampleRate 0; --------------------- triangle controls the drifting; the triangle wave forms a modulating oscillator driving the sample rate.; ports and knobs; These values give basic flanging.Knob LFOFreq 1 LFOFreq 0.3Knob LFODepth 1 Signed 0.05; Try these values for extreme pitch-shifted chorusing:; Driftback: 0.96; Frequency: 0.09; Amplitude: 1.0Instrument osc triangle_lfo.dspConnect   osc Output 0 - InputB 0Connect . LFOFreq 0 osc Frequency 0Connect . LFODepth 0 osc Amplitude 0; --------------------- 1-tap delay; see the reverb patch 1tap for a description of how this portion; works.Instrument  Send      delay_f1.dspMixer       Mixer     2 2Output Output 1 SignedKnob   InputGain    1 Signed +0.5Knob   FeedbackGain 1 Signed -0.8Knob   BypassGain   1 Signed +0.5Knob   DelayGain    1 Signed -0.5Expose SendFIFO Send OutFIFOExpose TapFIFO  Tap  InFIFOConnect Tap Output 0 Mixer Input 1Connect Mixer Output 0 . Output 0Connect Mixer Output 1 Send Input 0Connect . BypassGain   0 Mixer Gain 0Connect . DelayGain    0 Mixer Gain 1Connect . InputGain    0 Mixer Gain 2Connect . FeedbackGain 0 Mixer Gain 3DelayLine Delay 4000 1Attach    Delay SendFIFOAttach    Delay TapFIFO -startat 1000