;******************************************************************************;*;*  Copyright (c) 1993-1996, an unpublished work by The 3DO Company.;*  All rights reserved. This material contains confidential;*  information that is the property of The 3DO Company. Any;*  unauthorized duplication, disclosure or use is prohibited.;*  ;*  @(#) lowpass_comb.mp 95/12/15 1.2;*  Distributed with Portfolio V33.9;*  ;*  Three-tap delay line, each with a lowpass filter.;*;*  Filtering the basic multi-tap reverberator provides a way of modifying;*  the basic comb response of the tap.  For simplicity of control, we use;*  an svfilter as the filter element, which is somewhat expensive and not;*  too stable (try cranking the feedback gain, Q and sweeping the filter;*  frequency around for pretty nice feedback delay effects).  "Nicer";*  reverberators (in the files suffixed "1o1z") use a simple averaging;*  lowpass filter instead.;*;                        dry gain;                      +---+        dry signal;   +------------------| * |-------------------------------+;   |                  +---+                               |;   |                                                      v ;   |  +---+        +-------------------+                +---+;  -+->| + |------->|  delay            |                | + |----->;      |   |        +-------------+-+--++                |   | ;      |   |                      | |  |                 |   |;      |   |   +---+   +----+     | |  |                 |   |;      |   |<--| * |---| sv |-----+-|--|---------------->|   |;      |   |   +---+   +----+       |  |                 |   |;      |   |                        |  |                 |   |;      |   |   +---+   +----+       |  |                 |   |;      |   |<--| * |---| sv |-------+--|---------------->|   |;      |   |   +---+   +----+          |                 |   |;      |   |                           |                 |   |;      |   |   +---+   +----+          |                 |   |;      |   |<--| * |---| sv |----------+---------------->|   |;      |   |   +---+   +----+                            |   |;      +---+  feedback  filters                          +---+;             gains;;******************************************************************************; lpcomb; InstrumentsInput Input 1 SignedInstrument DelOut1 sampler_raw_f1.dspInstrument DelOut2 sampler_raw_f1.dspInstrument DelOut3 sampler_raw_f1.dspInstrument DelIn delay_f1.dspInstrument lp1 svfilter.dspInstrument lp2 svfilter.dspInstrument lp3 svfilter.dsp; We need a maximum delay of 0.1s = (0.1 * 44100 + 50) * 2 = 8920 bytesDelayline Delay 8920 1Mixer InMix 4 1Mixer OutMix 4 1Output Output 1 Signed; Hook up the delay line to the in and outExpose dOutFIFO1 DelOut1 InFIFOExpose dOutFIFO2 DelOut2 InFIFOExpose dOutFIFO3 DelOut3 InFIFOAttach Delay dOutFIFO1 -startat 2205	; 0.050 sAttach Delay dOutFIFO2 -startat 1940	; 0.056 sAttach Delay dOutFIFO3 -startat 1720	; 0.061 sExpose dInFIFO DelIn OutFIFOAttach Delay dInFIFO; Hook up the rest of the audio path; Connect	.	Input	0	InMix	Input	0Connect	lp1	Output	0	InMix	Input	1Connect	lp2	Output	0	InMix	Input	2Connect	lp3	Output	0	InMix	Input	3Connect	InMix	Output	0	DelIn	Input	0Connect DelOut1	Output	0	lp1	Input	0Connect DelOut2	Output	0	lp2	Input	0Connect DelOut3	Output	0	lp3	Input	0; Connect	.	Input	0	OutMix	Input	0Connect	DelOut1	Output	0	OutMix	Input	1Connect	DelOut2	Output	0	OutMix	Input	2Connect DelOut3	Output	0	OutMix	Input	3Connect OutMix	Output	0	.	Output	0; Preset some of the mixer gains.; Define knobs for tweaking mixKnob Dry	1 	Signed 	0.7	; input->outputKnob Wet	1 	Signed 	-0.3	; delay line->outputKnob g		1	Signed	-0.1009	; loop gainKnob g1		1	Signed	1	; lowpass gainKnob lpFreq	1	Signed	0.1Knob lpQ	1	Signed	0.2; Scale the wetInstrument *wet multiply.dspConstant *wet InputB 0 0.33		; 1/# of delays; Connect the knobs upConstant InMix	Gain	0	0.5	; input->delay line always full onConnect	.	g	0	InMix	Gain	1Connect	.	g	0	InMix	Gain	2Connect	.	g	0	InMix	Gain	3Connect	.	g1	0	lp1	Amplitude	0Connect	.	g1	0	lp2	Amplitude	0Connect	.	g1	0	lp3	Amplitude	0Connect	.	lpFreq	0	lp1	Frequency	0Connect	.	lpFreq	0	lp2	Frequency	0Connect	.	lpFreq	0	lp3	Frequency	0Connect	.	lpQ	0	lp1	Resonance	0Connect	.	lpQ	0	lp2	Resonance	0Connect	.	lpQ	0	lp3	Resonance	0Connect .	Dry	0	OutMix	Gain	0Connect	.	Wet	0	*wet	InputA	0Connect	*wet	Output	0	OutMix	Gain	1Connect	*wet	Output	0	OutMix	Gain	2Connect	*wet	Output	0	OutMix	Gain	3; That's it.  Here's some sample input.  Pick a sample off the command; line.; Instrument source sampler_16_f1.dsp; Expose InFIFO source InFIFO; Connect source	Output	0	InMix	Input	0; Connect source	Output	0	OutMix	Input	0; Or alternatively, uncomment out below, comment out above, and hook; something to the Input of the patch (say, line.in)Connect	.	Input	0	InMix	Input	0Connect	.	Input	0	OutMix	Input	0